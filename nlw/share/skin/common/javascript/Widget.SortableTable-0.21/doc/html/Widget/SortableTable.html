<html><head><title>Widget.SortableTable</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.03,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.008007 at Wed May 31 20:44:26 2006 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Widget.SortableTable - A widget to make a table sortable</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>Instruments a table so that each of its headers is a clickable link that resorts the table based on that column.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<ul>
<li>new Widget.SortableTable( { tableId: &#34;table-id&#34;,
...
} )
<p>Returns a new <code>Widget.SortableTable</code> object for the specified element.</p>

<p>This method expects an anonymous object as its only parameter.
The only required property for this object is &#34;tableId&#34;.</p>

<p>The columns of the table are numbered starting at 0,
from left to right</p>

<p>The object passed to the constructor can have several additional properties:</p>

<ul>
<li>initialSortColumn
<p>If &#34;initialSortColumn&#34; is specified,
it tells the widget what column it should sort the table on when the widget is created.</p>

<p>By default it does the initial sort of the table on column 0.</p>
</li>

<li>noInitialSort
<p>If this is true,
then no initial sort of table is done when the widget is constructed.</p>

<p>The appropriate even/odd CSS class names will still be added to each row,
but no cells will have their CSS class set to &#34;w-st-current-sorted-column&#34;.
See <a href="#HOW_THE_WIDGET_ALTERS_THE_TABLE" class="podlinkpod"
>&#34;HOW THE WIDGET ALTERS THE TABLE&#34;</a> for details about what this means.</p>
</li>

<li>secondarySortColumn
<p>The &#34;secondarySortColumn&#34; parameter specifies which column the widget should use for secondary sorting.
This is necessary when it tries to sort on a column where some cells contain identical values.
In this case,
it will fall back to sorting those particular rows on the data in the &#34;secondarySortColumn&#34;.
You should use a column which contains unique data in each cell.
This defaults to column 0.</p>
</li>

<li>columnSpecs
<p>The &#34;columnSpecs&#34; property is an array containing information about each column in the table.</p>

<p>The spec for a single column is an anonymous object which can contain three properties,
&#34;skip&#34;,
&#34;sort&#34;,
and &#34;defaultDir&#34;.
If &#34;skip&#34; is true,
then this column will not be sortable.
The &#34;sort&#34; property may be a custom sort function for that column,
or a type name.
See <a href="#TYPES_AND_SORTING" class="podlinkpod"
>&#34;TYPES AND SORTING&#34;</a> for more details on what type names are allowed.
Finally,
the &#34;defaultDir&#34; property may be either &#34;asc&#34; or &#34;desc&#34;.
This specifies which direction the column will be sorted on by default.</p>

<p>If you want do not want to give a spec for a column you can use &#34;null&#34; to fill its place in the array.</p>

<p>An example:</p>

<pre>  var table = new Widget.SortableTable( {
    &#34;tableId&#34;:           &#34;my-table&#34;,
    &#34;initialSortColumn&#34;: 1,
    &#34;columnSpecs&#34;: [
      null,                   no spec for column 0
      { skip: true },         do not sort column 1
      { sort: &#34;text&#34; },       sort column 2 as text
      { defaultDir: &#34;desc&#34; }, sort column 3 in descending order by default
      { sort: mySortFunc,     sort column 4 with a custom function ...
        defaultDir: &#34;desc&#34; }, ... sort in descending order by default
    ]
  } );</pre>
</li>

<li>onSortRowCallback
<p>If this option is given, this callback will be called when the rows are resorted. It will be passed the row and its new row number (starting at 1) in the table.</p>

<p>This is primarily provided to allow for row numbering:</p>

<pre>  function renumberRow (row, idx) {
      row.cells[0].innerHTML = &#34;row number &#34; + idx;
  }</pre>
</li>
</ul>

<p>Since this class uses <code>DOM.Ready</code> to get the table, you can create a widget object whenever you want during the course of page rendering.</p>
</li>

<li>sortOnColumn(number)
<p>Tells the widget to sort the table on the specified column. If the widget is not ready (the table is not in the DOM yet), then this method will simply return.</p>
</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Tables_with_One_Row"
>Tables with One Row</a></h2>

<p>You can create a widget for a table with one row, but sorting will be a no-op. Creating the widget will still alter the table, but since no initial sort will be done, its CSS will not be altered.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TYPES_AND_SORTING"
>TYPES AND SORTING</a></h1>

<p>By default, <code>Widget.SortTable</code> tries to figure out the type of a column based on its text contents. It currently recognizes four types of data, numeric (integer or floating point), currency (a number preceded by &#34;$&#34; or the Euro symbol), dates in YYYY-MM-DD format, and text.</p>

<p>Text is sorted case-insensitively. Dates are sorted in descending order by default.</p>

<p>It detects the type by looking at the second cell in the column (which may change depending on previous sorts). If this is blank for a column, it will assume that the type is text. If you have blank cells in a column and the data is not text, you should always specify its type when constructing the <code>Widget.SortTable</code> object.</p>

<p>Empty cells are sorted as being less than non-empty cells for all types.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="HOW_THE_WIDGET_ALTERS_THE_TABLE"
>HOW THE WIDGET ALTERS THE TABLE</a></h1>

<p>When the widget object is first instantiated, it makes a number of changes to the DOM for the table. It assumes that the first row contains column headers. For each cell, it takes the contents of the cell, whatever they may be, and wraps them in a new <code>&#60;a&#62;</code> tag. The href for this tag is &#34;#&#34;. The tag has an &#34;onClick&#34; event set which calls <code>sortOnColumn()</code> with the appropriate column number. Its class name is &#34;w-st-resort-column&#34;. It also has an &#34;onClick&#34; attribute set to &#34;return false;&#34; so that clicking it does not cause the browser to scroll the page.</p>

<p>Note that the addition of this <code>&#60;a&#62;</code> tag may have break existing CSS rules you are using.</p>

<p>The widget will call <code>sortOnColumn()</code> as soon as it can in order to establish an initial sort order for the table, unless you passed set the &#34;noInitialSort&#34; constructor parameter to true. If no initial sorting is done, then there is no current sort-by column, but all the other CSS changes are still applied.</p>

<p>When the table is sorted, the widget will make a number of changes to the class names for table elements. The changes are as follows:</p>

<ul>
<li>Current sort-by column
<p>All cells in this column will have the &#34;w-st-current-sorted-column&#34; class added. In addition, the header cell, at the top of the column, will also have the class &#34;w-st-asc-column-header&#34; or &#34;w-st-desc-column-header&#34;, depending on the current sort order.</p>
</li>

<li>Other column header cells
<p>All other header cells will be given the &#34;w-st-unsorted-column-header&#34; class.</p>
</li>

<li>Sort-by column changes
<p>When the column upon which the widget is sorting changes, it removes the &#34;w-st-current-sorted-column&#34; class from the previous sort-by column and remove the &#34;w-st-asc-column-header&#34; or &#34;w-st-desc-column-header&#34; class from that column&#39;s header cell.</p>
</li>

<li>All rows besides the header row
<p>These rows (<code>&#60;tr&#62;</code> tags) will be given a class of either &#34;w-st-odd-row&#34; or &#34;w-st-even-row&#34;. The first row below the headers will be even.</p>
</li>
</ul>

<p>Any class names you originally assigned in your HTML will be left untouched by the widget.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Current_Sort_Indicators"
>Current Sort Indicators</a></h2>

<p>This widget does not add any DOM elements to show which column is the current sort-by column. Instead, you can take advantage of the CSS class names it uses to get the same effect.</p>

<p>For example, let&#39;s start with this HTML for a column header cell:</p>

<pre>  &#60;th&#62;Name
      &#60;img class=&#34;none&#34; src=&#34;none.png&#34; /&#62;
      &#60;img class=&#34;asc&#34;  src=&#34;asc.png&#34; /&#62;
      &#60;img class=&#34;desc&#34; src=&#34;desc.png&#34; /&#62;
  &#60;/th&#62;</pre>

<p>Then in your CSS you can define the following style rules:</p>

<pre> img.asc, img.desc {
     display: none;
 }

 th.w-st-current-sorted-column img.none {
     display: none;
 }

 th.w-st-asc-column-header   img.asc  {
     display: inline;
 }

 th.w-st-desc-column-header  img.desc  {
     display: inline;
 }</pre>

<p>With these rules, the appropriate image will be displayed simply based on the class name changes that the widget makes.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Dave Rolsky, &#60;autarch@urth.org&#62;.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>Copyright (c) 2006 Dave Rolsky. All rights reserved.</p>

<p>This module is free software; you can redistribute it and/or modify it under the same terms as the Perl programming language (your choice of GPL or the Perl Artistic license).</p>

<!-- end doc -->

</body></html>
