<html>

<head>

 <script type="text/javascript" src="lib/JSAN.js"></script>
 <script type="text/javascript">
  JSAN.addRepository("lib", "../lib");
  JSAN.use("Test.More");
  JSAN.errorLevel = "die";
 </script>
 <style>
  table { border-collapse: collapse; margin-bottom: 1em }
  th, td { border: 1px solid black; padding: 1em; }
  a.w-st-resort-column { text-decoration: none }
  .w-st-current-sorted-column { background-color: #eee }
 </style>

</head>
<body>

 <table id="a-table">
  <tr id="row0">
   <th id="name-header">Name</th>
   <th id="size-header">Size</th>
  </tr>
  <tr id="row1">
   <td>A</td>
   <td>1</td>
  </tr>
  <tr id="row2">
   <td>B</td>
   <td>1</td>
  </tr>
  <tr id="row3">
   <td>C</td>
   <td>1</td>
  </tr>
  <tr id="row4">
   <td>D</td>
   <td>1</td>
  </tr>
 </table>

 <table id="another-table">
  <tr id="row0">
   <th id="name-header">Name</th>
   <th id="name2-header">Name 2</th>
   <th id="size-header">Size</th>
  </tr>
  <tr id="row1">
   <td>A</td>
   <td>Z</td>
   <td>1</td>
  </tr>
  <tr id="row2">
   <td>B</td>
   <td>Y</td>
   <td>1</td>
  </tr>
  <tr id="row3">
   <td>C</td>
   <td>X</td>
   <td>1</td>
  </tr>
  <tr id="row4">
   <td>D</td>
   <td>W</td>
   <td>1</td>
  </tr>
 </table>

 <pre style="white-space: pre" id="test"><script>

JSAN.use("Widget.SortableTable");
plan( { tests: 16 } );

{
    table = new Widget.SortableTable( { tableId: "a-table" } );

    table.sortOnColumn(1);
    var rows = document.getElementById("a-table").rows;
    is( rows[1].id, "row1", "row1 is now first - secondary sort on column 0" );
    is( rows[2].id, "row2", "row2 is now second - secondary sort on column 0" );
    is( rows[3].id, "row3", "row3 is now third - secondary sort on column 0" );
    is( rows[4].id, "row4", "row4 is now fourth - secondary sort on column 0" );

    table.sortOnColumn(1);
    var rows = document.getElementById("a-table").rows;
    is( rows[1].id, "row4", "row4 is now first - secondary sort on column 0" );
    is( rows[2].id, "row3", "row3 is now second - secondary sort on column 0" );
    is( rows[3].id, "row2", "row2 is now third - secondary sort on column 0" );
    is( rows[4].id, "row1", "row1 is now fourth - secondary sort on column 0" );

}

{
    table = new Widget.SortableTable( { tableId: "another-table",
                                        secondarySortColumn: 1 } );

    table.sortOnColumn(2);
    var rows = document.getElementById("another-table").rows;
    is( rows[1].id, "row4", "row4 is now first - secondary sort on column 1" );
    is( rows[2].id, "row3", "row3 is now second - secondary sort on column 1" );
    is( rows[3].id, "row2", "row2 is now third - secondary sort on column 1" );
    is( rows[4].id, "row1", "row1 is now fourth - secondary sort on column 1" );

    table.sortOnColumn(2);
    var rows = document.getElementById("another-table").rows;
    is( rows[1].id, "row1", "row1 is now first - secondary sort on column 1" );
    is( rows[2].id, "row2", "row2 is now second - secondary sort on column 1" );
    is( rows[3].id, "row3", "row3 is now third - secondary sort on column 1" );
    is( rows[4].id, "row4", "row4 is now fourth - secondary sort on column 1" );

}

 </script></pre>

</body>
</html>
